{
  "timestamp": "2025-07-26T16:39:05.618Z",
  "database": {
    "collections": {
      "users": {
        "documentCount": 1322,
        "avgDocumentSize": 1613,
        "totalSize": 2132577,
        "indexCount": 4,
        "indexSize": 176128,
        "indexSizeRatio": "8.26%"
      },
      "reports": {
        "documentCount": 1321,
        "avgDocumentSize": 2463,
        "totalSize": 3254141,
        "indexCount": 5,
        "indexSize": 217088,
        "indexSizeRatio": "6.67%"
      },
      "safezones": {
        "documentCount": 0,
        "avgDocumentSize": 0,
        "totalSize": 0,
        "indexCount": 6,
        "indexSize": 24576,
        "indexSizeRatio": "0%"
      },
      "devicefingerprints": {
        "documentCount": 1703,
        "avgDocumentSize": 2957,
        "totalSize": 5037421,
        "indexCount": 5,
        "indexSize": 262144,
        "indexSizeRatio": "5.20%"
      },
      "auditlogs": {
        "documentCount": 72417,
        "avgDocumentSize": 320,
        "totalSize": 23184857,
        "indexCount": 4,
        "indexSize": 6340608,
        "indexSizeRatio": "27.35%"
      }
    },
    "indexes": {
      "users": {
        "total": 4,
        "indexes": [
          {
            "name": "_id_",
            "keys": [
              "_id"
            ],
            "unique": false,
            "sparse": false,
            "background": false,
            "size": "unknown"
          },
          {
            "name": "user_primary_lookup",
            "keys": [
              "userType",
              "securityProfile.securityRiskLevel",
              "activityProfile.lastSeen"
            ],
            "unique": false,
            "sparse": false,
            "background": true,
            "size": "unknown"
          },
          {
            "name": "admin_operations",
            "keys": [
              "roleData.admin.username",
              "roleData.admin.email"
            ],
            "unique": false,
            "sparse": true,
            "background": true,
            "size": "unknown"
          },
          {
            "name": "security_monitoring",
            "keys": [
              "securityProfile.quarantineStatus",
              "securityProfile.overallTrustScore",
              "securityProfile.primaryDeviceFingerprint"
            ],
            "unique": false,
            "sparse": false,
            "background": true,
            "size": "unknown"
          }
        ],
        "redundant": [],
        "efficiency": 100
      },
      "reports": {
        "total": 5,
        "indexes": [
          {
            "name": "_id_",
            "keys": [
              "_id"
            ],
            "unique": false,
            "sparse": false,
            "background": false,
            "size": "unknown"
          },
          {
            "name": "report_moderation_queue",
            "keys": [
              "status",
              "moderation.priorityLevel",
              "timestamp"
            ],
            "unique": false,
            "sparse": false,
            "background": true,
            "size": "unknown"
          },
          {
            "name": "location_queries",
            "keys": [
              "location.coordinates",
              "status",
              "type"
            ],
            "unique": false,
            "sparse": false,
            "background": true,
            "size": "unknown"
          },
          {
            "name": "analytics_queries",
            "keys": [
              "type",
              "severity",
              "timestamp",
              "status"
            ],
            "unique": false,
            "sparse": false,
            "background": true,
            "size": "unknown"
          },
          {
            "name": "security_flags",
            "keys": [
              "securityFlags.potentialSpam",
              "securityFlags.crossBorderReport",
              "securityScore"
            ],
            "unique": false,
            "sparse": true,
            "background": true,
            "size": "unknown"
          }
        ],
        "redundant": [],
        "efficiency": 100
      },
      "safezones": {
        "total": 6,
        "indexes": [
          {
            "name": "_id_",
            "keys": [
              "_id"
            ],
            "unique": false,
            "sparse": false,
            "background": false,
            "size": "unknown"
          },
          {
            "name": "safezone_primary",
            "keys": [
              "status",
              "zoneType",
              "safetyScore"
            ],
            "unique": false,
            "sparse": false,
            "background": true,
            "size": "unknown"
          },
          {
            "name": "location_lookup",
            "keys": [
              "location.coordinates",
              "status",
              "radius"
            ],
            "unique": false,
            "sparse": false,
            "background": true,
            "size": "unknown"
          },
          {
            "name": "female_safety",
            "keys": [
              "femaleSafety.overallFemaleSafety",
              "femaleSafety.culturallyAppropriate",
              "status"
            ],
            "unique": false,
            "sparse": true,
            "background": true,
            "size": "unknown"
          },
          {
            "name": "time_based_safety",
            "keys": [
              "timeOfDaySafety.morning",
              "lastSafetyUpdate",
              "status"
            ],
            "unique": false,
            "sparse": false,
            "background": true,
            "size": "unknown"
          },
          {
            "name": "community_features",
            "keys": [
              "category",
              "communityRating.totalRatings",
              "communityRating.lastUpdated"
            ],
            "unique": false,
            "sparse": false,
            "background": true,
            "size": "unknown"
          }
        ],
        "redundant": [],
        "efficiency": 100
      },
      "devicefingerprints": {
        "total": 5,
        "indexes": [
          {
            "name": "_id_",
            "keys": [
              "_id"
            ],
            "unique": false,
            "sparse": false,
            "background": false,
            "size": "unknown"
          },
          {
            "name": "fingerprint_primary",
            "keys": [
              "fingerprintId"
            ],
            "unique": true,
            "sparse": false,
            "background": true,
            "size": "unknown"
          },
          {
            "name": "security_analysis",
            "keys": [
              "securityProfile.riskLevel",
              "securityProfile.trustScore",
              "activityHistory.lastSeen"
            ],
            "unique": false,
            "sparse": false,
            "background": true,
            "size": "unknown"
          },
          {
            "name": "user_device_lookup",
            "keys": [
              "userId",
              "activityHistory.lastSeen"
            ],
            "unique": false,
            "sparse": true,
            "background": true,
            "size": "unknown"
          },
          {
            "name": "threat_detection",
            "keys": [
              "threatIntelligence.threatConfidence",
              "networkProfile.vpnSuspected",
              "networkProfile.proxyDetected"
            ],
            "unique": false,
            "sparse": false,
            "background": true,
            "size": "unknown"
          }
        ],
        "redundant": [],
        "efficiency": 100
      },
      "auditlogs": {
        "total": 4,
        "indexes": [
          {
            "name": "_id_",
            "keys": [
              "_id"
            ],
            "unique": false,
            "sparse": false,
            "background": false,
            "size": "unknown"
          },
          {
            "name": "audit_primary",
            "keys": [
              "timestamp",
              "actionType",
              "severity"
            ],
            "unique": false,
            "sparse": false,
            "background": true,
            "size": "unknown"
          },
          {
            "name": "actor_tracking",
            "keys": [
              "actor.userId",
              "actor.userType",
              "timestamp"
            ],
            "unique": false,
            "sparse": true,
            "background": true,
            "size": "unknown"
          },
          {
            "name": "outcome_analysis",
            "keys": [
              "outcome",
              "actionType",
              "timestamp"
            ],
            "unique": false,
            "sparse": false,
            "background": true,
            "size": "unknown"
          }
        ],
        "redundant": [],
        "efficiency": 100
      }
    },
    "connectionPool": {
      "connectionState": "connected",
      "currentConnections": 36,
      "availableConnections": 51164,
      "totalCreated": 9820,
      "maxPoolSize": 100,
      "minPoolSize": 10,
      "socketTimeout": 45000,
      "serverSelectionTimeout": 5000
    },
    "queryPerformance": {
      "testResults": [
        {
          "name": "pending_reports",
          "collection": "reports",
          "executionTime": 4,
          "resultCount": 10,
          "performance": "excellent"
        },
        {
          "name": "location_reports",
          "collection": "reports",
          "executionTime": 2,
          "resultCount": 0,
          "performance": "excellent"
        },
        {
          "name": "active_safezones",
          "collection": "safezones",
          "executionTime": 0,
          "resultCount": 0,
          "performance": "excellent"
        },
        {
          "name": "admin_users",
          "collection": "users",
          "executionTime": 0,
          "resultCount": 1,
          "performance": "excellent"
        },
        {
          "name": "high_risk_devices",
          "collection": "devicefingerprints",
          "executionTime": 0,
          "resultCount": 0,
          "performance": "excellent"
        }
      ],
      "avgQueryTime": 1.2,
      "slowQueries": []
    },
    "avgQueryTime": 1.2,
    "slowQueries": []
  },
  "middleware": {
    "stackAnalysis": [],
    "averageOverhead": 0,
    "heaviestMiddleware": []
  },
  "cache": {
    "status": "connected",
    "hitRate": "0%",
    "hits": 0,
    "misses": 0,
    "sets": 0,
    "deletes": 0,
    "memoryUsage": "1.82M",
    "latency": "1ms"
  },
  "routes": {
    "slowestEndpoints": [],
    "errorProneRoutes": [],
    "highTrafficRoutes": []
  },
  "memory": {
    "heapUsed": 20.15,
    "heapTotal": 57.16,
    "external": 19.53,
    "arrayBuffers": 17.44,
    "rss": 94.62
  },
  "recommendations": [
    {
      "priority": "medium",
      "category": "cache",
      "issue": "Low cache hit rate (0%)",
      "recommendation": "Optimize cache strategy and TTL values",
      "expectedImprovement": "30-50% cache efficiency gain"
    }
  ]
}